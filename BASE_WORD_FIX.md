# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ë–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ –Ω–µ –¥–æ–±–∞–≤–ª—è–ª–æ—Å—å –≤ usedWords

## üêõ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π –∏–≥—Ä—ã –±–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ê–§–ò–®–ê", "–ë–ê–õ–î–ê") –Ω–µ –¥–æ–±–∞–≤–ª—è–ª–æ—Å—å –≤ —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö —Å–ª–æ–≤ (`usedWords`).

### –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è

–ò–≥—Ä–æ–∫–∏ –º–æ–≥–ª–∏ **–ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—á–∫–æ–≤:

1. –ë–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ "–ê–§–ò–®–ê" —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è –≤ —Ü–µ–Ω—Ç—Ä–µ –¥–æ—Å–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–≥—Ä—ã
2. –ò–≥—Ä–æ–∫ –¥–æ–±–∞–≤–ª—è–µ—Ç –±—É–∫–≤—É —Ä—è–¥–æ–º —Å –±–∞–∑–æ–≤—ã–º —Å–ª–æ–≤–æ–º
3. –ò–≥—Ä–æ–∫ –æ–±—ä—è–≤–ª—è–µ—Ç —Å–ª–æ–≤–æ "–ê–§–ò–®–ê" (–∫–æ—Ç–æ—Ä–æ–µ —É–∂–µ –±—ã–ª–æ –Ω–∞ –¥–æ—Å–∫–µ!)
4. ‚úÖ –ò–≥—Ä–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ö–æ–¥ –∏ –Ω–∞—á–∏—Å–ª—è–µ—Ç –æ—á–∫–∏
5. ‚ùå **–≠—Ç–æ –Ω–µ—á–µ—Å—Ç–Ω–æ!** –°–ª–æ–≤–æ —É–∂–µ –±—ã–ª–æ –Ω–∞ –¥–æ—Å–∫–µ —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞

### –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã –ë–∞–ª–¥–∞

–í –Ω–∞—Å—Ç–æ—è—â–µ–π –∏–≥—Ä–µ –ë–∞–ª–¥–∞:
- ‚úÖ –ë–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è –Ω–∞ –¥–æ—Å–∫–µ –≤ –Ω–∞—á–∞–ª–µ –∏–≥—Ä—ã
- ‚úÖ –ò–≥—Ä–æ–∫–∏ –º–æ–≥—É—Ç **–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±—É–∫–≤—ã** –∏–∑ –±–∞–∑–æ–≤–æ–≥–æ —Å–ª–æ–≤–∞ –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —Å–ª–æ–≤
- ‚ùå –ò–≥—Ä–æ–∫–∏ **–ù–ï –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∞–º–æ –±–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ** –∫–∞–∫ —Ö–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—á–∫–æ–≤
- ‚úÖ –ö–∞–∂–¥–æ–µ —Å–ª–æ–≤–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–î–æ–±–∞–≤–ª–µ–Ω–æ –±–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ –≤ `usedWords` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–≥—Ä—ã.

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

**src/engine/balda.ts, —Å—Ç—Ä–æ–∫–∞ 493:**

```typescript
// –î–û:
return {
  id,
  size,
  board,
  players: normalizedPlayers,
  currentPlayerIndex: 0,
  moves: [],
  createdAt: Date.now(),
  scores,
  usedWords: [],  // ‚ùå –ë–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ –Ω–µ –≤ —Å–ø–∏—Å–∫–µ!
}

// –ü–û–°–õ–ï:
return {
  id,
  size,
  board,
  players: normalizedPlayers,
  currentPlayerIndex: 0,
  moves: [],
  createdAt: Date.now(),
  scores,
  usedWords: [normalizeWord(baseWord)],  // ‚úÖ –ë–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ!
}
```

### –ü–æ—á–µ–º—É `normalizeWord(baseWord)`?

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `normalizeWord(baseWord)` –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏:
- –í—Å–µ —Å–ª–æ–≤–∞ –≤ `usedWords` —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ (–Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä)
- –ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –Ω–∞ —Å—Ç—Ä–æ–∫–µ 430 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `game.usedWords.includes(word)` –≥–¥–µ `word` —É–∂–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ
- –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞ –≤–≤–æ–¥–∞

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```
‚ùå –ë–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—á–∫–æ–≤
‚ùå –ò–≥—Ä–æ–∫–∏ –º–æ–≥–ª–∏ "–æ–±–º–∞–Ω—ã–≤–∞—Ç—å" —Å–∏—Å—Ç–µ–º—É
‚ùå –ü–µ—Ä–≤—ã–π –∏–≥—Ä–æ–∫ –º–æ–≥ —Å—Ä–∞–∑—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ
‚ùå –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –∏–≥—Ä—ã –ë–∞–ª–¥–∞
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```
‚úÖ –ë–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–µ
‚úÖ –ü–æ–ø—ã—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º "Word already used in this game"
‚úÖ –ò–≥—Ä–æ–∫–∏ –¥–æ–ª–∂–Ω—ã —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ù–û–í–´–ï —Å–ª–æ–≤–∞
‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–∏–ª–∞–º –∏–≥—Ä—ã –ë–∞–ª–¥–∞
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–≥—Ä—É:
   ```bash
   bun run cli
   ```

2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –∏–≥—Ä—É —Å –±–∞–∑–æ–≤—ã–º —Å–ª–æ–≤–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ë–ê–õ–î–ê")

3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–¥–µ–ª–∞—Ç—å —Ö–æ–¥ —Å –±–∞–∑–æ–≤—ã–º —Å–ª–æ–≤–æ–º:
   - –î–æ–±–∞–≤—å—Ç–µ –±—É–∫–≤—É —Ä—è–¥–æ–º —Å "–ë–ê–õ–î–ê"
   - –í–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ "–ë–ê–õ–î–ê"

4. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 
   ```
   ‚ùå –û—à–∏–±–∫–∞: Word already used in this game
   ```

### –ü—Ä–∏–º–µ—Ä –≤–∞–ª–∏–¥–Ω–æ–≥–æ –≥–µ–π–º–ø–ª–µ—è

```
–ë–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ: –ê–§–ò–®–ê

–•–æ–¥ 1:
  ‚Ä¢ –î–æ–±–∞–≤–∏—Ç—å "–õ" –≤ –ø–æ–∑–∏—Ü–∏—é 1–ê
  ‚Ä¢ –°–æ—Å—Ç–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ "–®–ê–õ–ê–®" (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –® –∏–∑ –ê–§–ò–®–ê + –Ω–æ–≤—É—é –õ)
  ‚úÖ –ü—Ä–∏–Ω—è—Ç–æ! +5 –æ—á–∫–æ–≤

–•–æ–¥ 2 (–ø–æ–ø—ã—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ):
  ‚Ä¢ –î–æ–±–∞–≤–∏—Ç—å "–§" –≤ –ø–æ–∑–∏—Ü–∏—é 2–ê
  ‚Ä¢ –°–æ—Å—Ç–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ "–ê–§–ò–®–ê" (–±–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ)
  ‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ: Word already used in this game
```

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–≥—Ä

**–í–∞–∂–Ω–æ:** –°—Ç–∞—Ä—ã–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∏–≥—Ä—ã –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –±–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ –≤ `usedWords`.

### –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

```bash
rm -rf data/games/*
```

–£–¥–∞–ª–µ–Ω—ã –≤—Å–µ —Å—Ç–∞—Ä—ã–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –∏–≥—Ä—ã –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π.

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

–ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏–≥—Ä—ã, –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é:

```typescript
// –ü—Ä–∏–º–µ—Ä –º–∏–≥—Ä–∞—Ü–∏–∏ (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏)
async function migrateGames() {
  const games = await store.getKeys()
  
  for (const gameId of games) {
    const game = await store.get(gameId)
    if (!game) continue
    
    // –ù–∞–π—Ç–∏ –±–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ –Ω–∞ –¥–æ—Å–∫–µ
    const centerRow = Math.floor(game.size / 2)
    const baseWord = game.board[centerRow]
      .filter(cell => cell !== null)
      .join('')
    
    // –î–æ–±–∞–≤–∏—Ç—å –≤ usedWords –µ—Å–ª–∏ –µ—â—ë –Ω–µ —Ç–∞–º
    if (!game.usedWords.includes(baseWord)) {
      game.usedWords.unshift(baseWord)
      await store.set(game)
    }
  }
}
```

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- **src/engine/balda.ts** - —Ñ—É–Ω–∫—Ü–∏—è `createGame` (—Å—Ç—Ä–æ–∫–∞ 467-495)
- **src/schemas.ts** - —Å—Ö–µ–º–∞ `GameStateSchema` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É `usedWords`
- **src/store.ts** - —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∏–≥—Ä

## üîç –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ GameState

```typescript
interface GameState {
  id: string
  size: number
  board: Letter[][]
  players: string[]
  currentPlayerIndex: number
  moves: Move[]
  createdAt: number
  scores: Record<string, number>
  usedWords: string[]  // –¢–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç –±–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã (—Å—Ç—Ä–æ–∫–∞ 429-432)

```typescript
// Uniqueness check
if (game.usedWords.includes(word)) {
  return { ok: false, message: 'Word already used in this game' }
}
```

–≠—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Å–ª–æ–≤, –≤–∫–ª—é—á–∞—è –±–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–æ —Ç–µ–ø–µ—Ä—å –≤ —Å–ø–∏—Å–∫–µ `usedWords` —Å –º–æ–º–µ–Ω—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä—ã.

## ‚úÖ –°—Ç–∞—Ç—É—Å

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ** - 11 –æ–∫—Ç—è–±—Ä—è 2025

–ë–∞–∑–æ–≤–æ–µ —Å–ª–æ–≤–æ —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏–≥—Ä—ã! üéâ

